webpackJsonp([7],{XIUn:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("3cXf"),r=a.n(s),n=a("Xug0"),i=a.n(n),o=a("uAC3"),c=a.n(o);var u={name:"setting",data:function(){return{avatarDefault:i.a,userInfo:c.a.get("user")?JSON.parse(c.a.get("user")):{}}},activated:function(){this.userInfo=c.a.get("user")?JSON.parse(c.a.get("user")):{}},methods:{goback:function(){this.$router.go(-1)},_updateUser:function(){var t,e=this;this.userInfo.createDate=this._dateParse(this.userInfo.createDate),this.userInfo.updateDate=this._dateParse(this.userInfo.updateDate),(t=this.userInfo,fetch.post("/user/updateUser",t)).then(function(t){e.$createToast({txt:"操作成功",time:2e3,type:"correct"}).show(),c.a.set("user",r()(e.userInfo)),e.$router.push({path:"/my"})}).catch(function(t){e.$createToast({txt:t.message,time:2e3,type:"error"}).show()})},_dateParse:function(t){if(t){var e=new Date(t).toLocaleDateString(),a=new Date(t).toLocaleTimeString();return e+" "+(a=a.substring(2,a.length-1))}return""},_updateAvatar:function(t){var e=this;this.loading=this.$createToast({txt:"Loading...",time:0,mask:!0}).show();var a,s=new FormData(document.getElementById("fileUpload"));(a=s,fetch.post("/tools/fileUpload",a)).then(function(t){200===t.code?(e.userInfo.avatar=t.data,e.loading.hide(),document.querySelector("#avatar").value=""):e.$createToast({txt:t.message,time:2e3,type:"error"}).show()}).catch(function(t){e.$createToast({txt:t.message,time:2e3,type:"error"}).show(),document.querySelector("#avatar").value=""})}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"setting"},[a("div",{staticClass:"nav flex"},[a("div",{staticClass:"flex-1"},[a("span",{staticClass:"cubeic-back",on:{click:t.goback}})]),t._v(" "),a("div",{staticClass:"flex-1"},[t._v("设置")])]),t._v(" "),a("div",{staticClass:"setting-form"},[a("div",{staticClass:"func-item"},[a("div",{staticClass:"func-inner"},[a("label",[t._v("头像")]),t._v(" "),a("div",{staticClass:"right"},[a("form",{attrs:{id:"fileUpload"}},[a("input",{attrs:{type:"file",accept:"image/*",name:"avatar",id:"avatar"},on:{change:t._updateAvatar}})]),t._v(" "),a("img",{attrs:{src:t.userInfo.avatar?t.userInfo.avatar:t.avatarDefault,width:"20",height:"20"}}),t._v(" "),a("i",{staticClass:"cubeic-arrow"})])])]),t._v(" "),a("div",{staticClass:"func-item"},[a("div",{staticClass:"func-inner"},[a("label",[t._v("昵称")]),t._v(" "),a("div",{staticClass:"right"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.userInfo.account,expression:"userInfo.account"}],attrs:{placeholder:"write your nickname"},domProps:{value:t.userInfo.account},on:{input:function(e){e.target.composing||t.$set(t.userInfo,"account",e.target.value)}}}),t._v(" "),a("i",{staticClass:"cubeic-arrow"})])]),t._v(" "),a("div",{staticClass:"func-inner"},[a("label",[t._v("签名")]),t._v(" "),a("div",{staticClass:"right"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.userInfo.slogon,expression:"userInfo.slogon"}],attrs:{placeholder:"write your slogon"},domProps:{value:t.userInfo.slogon},on:{input:function(e){e.target.composing||t.$set(t.userInfo,"slogon",e.target.value)}}}),t._v(" "),a("i",{staticClass:"cubeic-arrow"})])])])]),t._v(" "),a("div",{staticClass:"save-btn"},[a("button",{on:{click:t._updateUser}},[t._v("保存")])])])},staticRenderFns:[]};var v=a("C7Lr")(u,l,!1,function(t){a("saVZ")},null,null);e.default=v.exports},saVZ:function(t,e){}});
//# sourceMappingURL=7.257e491b956f81af7b4d.js.map